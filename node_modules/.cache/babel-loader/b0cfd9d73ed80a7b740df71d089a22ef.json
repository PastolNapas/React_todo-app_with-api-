{"ast":null,"code":"var _jsxFileName = \"/Applications/Html/leha/Todo-list_React/src/components/Auth/AuthForm.tsx\",\n    _s = $RefreshSig$();\n\nimport classNames from 'classnames';\nimport React, { useEffect, useState } from 'react';\nimport { createUser, getUserByEmail } from '../../api/users';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthForm = ({\n  onLogin\n}) => {\n  _s();\n\n  const [email, setEmail] = useState('');\n  const [name, setName] = useState('');\n  const [needToRegister, setNeedToRegister] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n\n  const saveUser = user => {\n    localStorage.setItem('user', JSON.stringify(user));\n    onLogin(user);\n  };\n\n  useEffect(() => {\n    const userData = localStorage.getItem('user');\n\n    if (!userData) {\n      return;\n    }\n\n    try {\n      const user = JSON.parse(userData);\n      onLogin(user);\n    } catch (error) {// Need to login\n    }\n  }, []);\n\n  const loadUser = async () => {\n    const user = await getUserByEmail(email);\n\n    if (user) {\n      saveUser(user);\n    } else {\n      setNeedToRegister(true);\n    }\n  };\n\n  const registerUser = () => {\n    return createUser({\n      name,\n      email\n    }).then(saveUser);\n  };\n\n  const handleSubmit = async event => {\n    event.preventDefault();\n    setErrorMessage('');\n    setLoading(true);\n\n    try {\n      if (needToRegister) {\n        await registerUser();\n      } else {\n        await loadUser();\n      }\n    } catch (error) {\n      setErrorMessage('Something went wrtong');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    className: \"box mt-5\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"title is-3\",\n      children: needToRegister ? 'You need to register' : 'Log in to open todos'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"field\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"label\",\n        htmlFor: \"user-email\",\n        children: \"Email\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classNames('control has-icons-left', {\n          'is-loading': loading\n        }),\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"email\",\n          id: \"user-email\",\n          className: classNames('input', {\n            'is-danger': !needToRegister && errorMessage\n          }),\n          placeholder: \"Enter your email\",\n          disabled: loading || needToRegister,\n          value: email,\n          required: true,\n          onChange: e => setEmail(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"icon is-small is-left\",\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fas fa-envelope\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this), !needToRegister && errorMessage && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"help is-danger\",\n        children: errorMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }, this), needToRegister && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"field\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        className: \"label\",\n        htmlFor: \"user-name\",\n        children: \"Your Name\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classNames('control has-icons-left', {\n          'is-loading': loading\n        }),\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          id: \"user-name\",\n          className: classNames('input', {\n            'is-danger': needToRegister && errorMessage\n          }),\n          placeholder: \"Enter your name\",\n          required: true,\n          minLength: 4,\n          disabled: loading,\n          value: name,\n          onChange: e => setName(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"icon is-small is-left\",\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fas fa-user\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 11\n      }, this), needToRegister && errorMessage && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"help is-danger\",\n        children: errorMessage\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"field\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: classNames('button is-primary', {\n          'is-loading': loading\n        }),\n        children: needToRegister ? 'Register' : 'Login'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 5\n  }, this);\n};\n\n_s(AuthForm, \"tPIjNbskzau5AM9CD7eknfIxxw4=\");\n\n_c = AuthForm;\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthForm\");","map":{"version":3,"sources":["/Applications/Html/leha/Todo-list_React/src/components/Auth/AuthForm.tsx"],"names":["classNames","React","useEffect","useState","createUser","getUserByEmail","AuthForm","onLogin","email","setEmail","name","setName","needToRegister","setNeedToRegister","loading","setLoading","errorMessage","setErrorMessage","saveUser","user","localStorage","setItem","JSON","stringify","userData","getItem","parse","error","loadUser","registerUser","then","handleSubmit","event","preventDefault","e","target","value"],"mappings":"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","sourcesContent":["import classNames from 'classnames';\nimport React, { useEffect, useState } from 'react';\nimport { createUser, getUserByEmail } from '../../api/users';\nimport { User } from '../../types/User';\n\nexport type Props = {\n  onLogin: (user: User) => void,\n};\n\nexport const AuthForm: React.FC<Props> = ({ onLogin }) => {\n  const [email, setEmail] = useState('');\n  const [name, setName] = useState('');\n  const [needToRegister, setNeedToRegister] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n\n  const saveUser = (user: User) => {\n    localStorage.setItem('user', JSON.stringify(user));\n    onLogin(user);\n  };\n\n  useEffect(() => {\n    const userData = localStorage.getItem('user');\n\n    if (!userData) {\n      return;\n    }\n\n    try {\n      const user = JSON.parse(userData) as User;\n\n      onLogin(user);\n    } catch (error) {\n      // Need to login\n    }\n  }, []);\n\n  const loadUser = async () => {\n    const user = await getUserByEmail(email);\n\n    if (user) {\n      saveUser(user);\n    } else {\n      setNeedToRegister(true);\n    }\n  };\n\n  const registerUser = () => {\n    return createUser({ name, email })\n      .then(saveUser);\n  };\n\n  const handleSubmit = async (event: React.FormEvent) => {\n    event.preventDefault();\n\n    setErrorMessage('');\n    setLoading(true);\n\n    try {\n      if (needToRegister) {\n        await registerUser();\n      } else {\n        await loadUser();\n      }\n    } catch (error) {\n      setErrorMessage('Something went wrtong');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"box mt-5\">\n      <h1 className=\"title is-3\">\n        {needToRegister ? 'You need to register' : 'Log in to open todos'}\n      </h1>\n\n      <div className=\"field\">\n        <label className=\"label\" htmlFor=\"user-email\">\n          Email\n        </label>\n\n        <div\n          className={classNames('control has-icons-left', {\n            'is-loading': loading,\n          })}\n        >\n          <input\n            type=\"email\"\n            id=\"user-email\"\n            className={classNames('input', {\n              'is-danger': !needToRegister && errorMessage,\n            })}\n            placeholder=\"Enter your email\"\n            disabled={loading || needToRegister}\n            value={email}\n            required\n            onChange={e => setEmail(e.target.value)}\n          />\n\n          <span className=\"icon is-small is-left\">\n            <i className=\"fas fa-envelope\" />\n          </span>\n        </div>\n\n        {!needToRegister && errorMessage && (\n          <p className=\"help is-danger\">{errorMessage}</p>\n        )}\n      </div>\n\n      {needToRegister && (\n        <div className=\"field\">\n          <label className=\"label\" htmlFor=\"user-name\">\n            Your Name\n          </label>\n\n          <div\n            className={classNames('control has-icons-left', {\n              'is-loading': loading,\n            })}\n          >\n            <input\n              type=\"text\"\n              id=\"user-name\"\n              className={classNames('input', {\n                'is-danger': needToRegister && errorMessage,\n              })}\n              placeholder=\"Enter your name\"\n              required\n              minLength={4}\n              disabled={loading}\n              value={name}\n              onChange={e => setName(e.target.value)}\n            />\n\n            <span className=\"icon is-small is-left\">\n              <i className=\"fas fa-user\" />\n            </span>\n          </div>\n\n          {needToRegister && errorMessage && (\n            <p className=\"help is-danger\">{errorMessage}</p>\n          )}\n        </div>\n      )}\n\n      <div className=\"field\">\n        <button\n          type=\"submit\"\n          className={classNames('button is-primary', {\n            'is-loading': loading,\n          })}\n        >\n          {needToRegister ? 'Register' : 'Login'}\n        </button>\n      </div>\n    </form>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}